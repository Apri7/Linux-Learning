# Linux权限管控
***
## 一、Linux的root用户
**1、root用户**
无论是Windows、MacOS、Linux均采用多用户的管理模式进行权限管理。
+ 在Linux中，拥有最大权限的账户名为：root（超级管理员）
+ 普通用户的权限，一般在其HOME目录内是不受限的。
+ 一旦出了HOME目录，大多数地方普通用户仅有只读和执行权限，无修改权限。

**2、su和exit命令**
+ 含义：switch user
+ 语法：`su [-] 用户名`
   + -符号是可选的，表示是否在切换用户后加载环境变量，建议带上。
   + 参数：用户名，表示要切换的用户，若省略则切换到root
   + 切换用户后，可以通过exit命令退回上一个用户，或使用快捷键：`ctrl+d`
+ 从普通用户切换用户需要输入密码，若从root切换用户则不用输入密码

**3、sudo命令**
+ 不建议长期使用root用户，避免损坏系统。
+ 因此使用sudo命令，为普通的命令授权，临时以root身份执行，
+ 语法：`sudo 其他命令`
+ 并不是所有用户都有权利使用sudo，需要为普通用户配置sudo认证：
  ```
   切换到root用户，执行visudo命令，会自动通过vi编辑器打开：/etc/sudoers
  在文件的最后添加`username ALL=(ALL)     NOPASSWD: ALL`
  `NOPASSWD: ALL`表示使用sudo命令，无需输入密码
  最后通过wq保存
  ```  

## 二、用户和用户组
**1、用户、用户组**
Linux系统中可以：
+ 配置多个用户
+ 配置多个用户组
+ 用户可以加入多个用户组

Linux中关于权限的管控级别有两个：
+ 针对用户的权限管控
+ 针对用户组的权限管控

**2、用户组管理**
以下命令需root用户执行
+ 创建用户组：`groupadd 用户组名`
+ 删除用户组：`groupdel 用户组名`

**3、用户管理**
以下命令需root用户执行
+ 创建用户
  `useradd 用户名 [-g 用户组名] [-d HOME路径]`
  + 选项：-g指定用户的组，不指定-g会创建同名组并自动加入，指定-g需要组已经存在，若已存在同名组，必须使用-g。
  + 选项：-d指定用户HOME路径，不指定则HOME默认在：/home/用户名。
+ 删除用户
  `userdel [-r] 用户名`
  + 选项:-r，删除用户的HOME目录，不使用则删除用户时保留HOME目录
+ 查看用户所属组
  `id [用户名]`
  + 参数：用户名，表示被查看的用户，若不提供则查看自身
+ 增加用户所属组
  `usermod -aG 用户组 用户名`
  将指定用户加入指定的用户组

**4、getent**
1. 查看当前系统有哪些用户
   + 语法：`getent passwd`
   + 会有7个信息：
     用户名：密码(x):用户ID：组ID：描述信息（无用）：HOME目录：执行终端（默认bash）

2. 查看当前系统有哪些用户组
   + 语法：`getent group`
   + 会提供三个信息：
     组名称：组认证（显示为x）：组ID


## 三、查看权限控制
**1、认识权限信息**
通过`ls -l`可以以列表的形式查看内容，并显示文件/文件夹的权限细节、所属用户、所属用户组。
权限细节共10个槽位。
|  | 所属用户权限 | 所属用户组权限 | 其他用户权限 |
|:---|:---|:---|:---|
|-或d或l|r或-；w或-；x或-|r或-；w或-；x或-|r或-；w或-；x或-|  

第一位：-表示文件，d表示文件夹，l表示软连接
r：read，可读。
w：write，可写（创建、删除、改名、修改等）。
x：execute，可执行，针对文件夹表示可以更改工作目录到此文件夹，即cd进入；针对文件表示可以作为程序执行。
[例]drwxr-xr-x,表示：
+ d：这是一个文件夹
+ rwx：所属用户的权限是有r有w有x
+ r-x：所属用户组的权限是有r无w有x
+ r-x:其他用户的权限是有r无w有x

## 四、修改权限控制-chmod命令
**1、chmod命令**
可以使用chmod命令修改文件/文件夹的权限信息。
**注意：只有文件/文件夹的所属用户或root用户可以修改。**
语法：`chmod -[R] 权限 文件/文件夹`
+ 选项：-R，对文件夹内的全部内容进行修改操作。

[例1]chmod u=rwx,g=rx,o=x hello.txt
     将文件权限修改为：rwxr-x--x
     其中，u（user）表示所属用户权限，g（group）表示组权限，o（other）表示其他用户权限
[例2]chmod -R u=rwx,g=rx,o=x test
     修改文件夹test以及文件夹内全部文件的权限为：rwxr-x--x

**2、权限的数字序号**
权限可以用3为数字来表示，第一位数字表示用户权限，第二位数字表示用户组权限，第三位数字表示其他用户权限。
r记为4，w记为2，x记为1。
+ 0：---
+ 1：--x
+ 2：-w-
+ 3：-wx
+ 4：r--
+ 5：r-x
+ 6：rw-
+ 7：rwx
[例]751：rwxr-x--x

## 五、修改权限控制-chown命令
**1、chown命令**
可以使用chown命令修改文件/文件夹的所属用户和用户组。
**此命令只能由root用户执行。**
语法：`chown [-R] [用户] [:] [用户组] [文件/文件夹]`
+ 选项：-R，对文件夹及其内容都进行修改操作
+ 选项：用户，修改所属用户
+ 选项：用户组，修改所属用户组
+ ：用于分隔用户和用户组（若不修改所属用户但修改所属用户组也要用上：）
  